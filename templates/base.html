<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{% block title %}OnlyClownsðŸ¤¡{% endblock %}</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='youface.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='fun.css') }}">

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    {% block head %}{% endblock %}
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand fw-bold" href="{{ url_for('login.index') }}">ðŸŽª OnlyClowns</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav ms-auto">
                <!-- Home button -->
                <li class="nav-item me-2">
                    <a href="{{ url_for('login.index') }}" class="btn btn-primary btn-sm">Home</a>
                </li>

                {% if user %}
                    <!-- Edit Profile -->
                    <li class="nav-item me-2">
                        <a href="{{ url_for('profile.edit_profile') }}" class="btn btn-secondary btn-sm">Edit Profile</a>
                    </li>

                    <!-- Find Friends -->
                    <li class="nav-item me-2">
                        <a href="{{ url_for('friends.find_friends') }}" class="btn btn-success btn-sm">Find Friends</a>
                    </li>

                    <!-- Logout -->
                    <li class="nav-item">
                        <form method="post" action="/logout" class="d-inline">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                            <button type="submit" class="btn btn-secondary btn-sm">Logout</button>
                        </form>
                    </li>
                {% else %}
                    <!-- Login -->
                    <li class="nav-item">
                        <a href="{{ url_for('login.loginscreen') }}" class="btn btn-light btn-sm">Login</a>
                    </li>
                {% endif %}

                <!-- Dark/Light mode toggle -->
                <li class="nav-item ms-2">
                    <button id="darkModeToggle" class="btn btn-outline-secondary btn-sm">
                        ðŸŒ™ Dark Mode
                    </button>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container py-5">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</div>

<!-- Dark mode script -->
<script>
    const toggleButton = document.getElementById('darkModeToggle');
    const body = document.body;

    // Load saved preference
    if (localStorage.getItem('dark-mode') === 'enabled') {
        body.classList.add('dark-mode');
        toggleButton.textContent = ' Light Mode';
    }

    toggleButton.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        if (body.classList.contains('dark-mode')) {
            localStorage.setItem('dark-mode', 'enabled');
            toggleButton.textContent = ' Light Mode';
        } else {
            localStorage.setItem('dark-mode', 'disabled');
            toggleButton.textContent = 'ðŸŒ™ Dark Mode';
        }
    });
</script>

{% block scripts %}
{% endblock %}
</body>
</html>
